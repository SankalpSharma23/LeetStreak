import{r as g,j as e,F as b,T as N,C as v,a as w,R as E,b as S}from"./globals-Dv-pJP64.js";const F="modulepreload",A=function(d,h){return new URL(d,h).href},j={},y=function(h,c,m){let a=Promise.resolve();if(c&&c.length>0){let f=function(r){return Promise.all(r.map(t=>Promise.resolve(t).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const l=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),p=n?.nonce||n?.getAttribute("nonce");a=f(c.map(r=>{if(r=A(r,m),r in j)return;j[r]=!0;const t=r.endsWith(".css"),x=t?'[rel="stylesheet"]':"";if(m)for(let s=l.length-1;s>=0;s--){const o=l[s];if(o.href===r&&(!t||o.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${x}`))return;const i=document.createElement("link");if(i.rel=t?"stylesheet":F,t||(i.as="script"),i.crossOrigin="",i.href=r,p&&i.setAttribute("nonce",p),document.head.appendChild(i),t)return new Promise((s,o)=>{i.addEventListener("load",s),i.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${r}`)))})}))}function u(l){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=l,window.dispatchEvent(n),!n.defaultPrevented)throw l}return a.then(l=>{for(const n of l||[])n.status==="rejected"&&u(n.reason);return h().catch(u)})};function R(d){if(!d)return"Never";const c=Date.now()-d,m=Math.floor(c/6e4),a=Math.floor(c/36e5);if(m<1)return"Just now";if(m<60)return`${m} min${m>1?"s":""} ago`;if(a<24)return`${a} hour${a>1?"s":""} ago`;const u=Math.floor(c/864e5);return`${u} day${u>1?"s":""} ago`}function D({friends:d,loading:h,onFriendRemoved:c,onFriendAdded:m}){const[a,u]=g.useState(""),[l,n]=g.useState(!1),[p,f]=g.useState(""),[r,t]=g.useState(""),x=async s=>{if(s.preventDefault(),!a.trim()){f("Please enter a username");return}n(!0),f(""),t("");try{const o=await chrome.runtime.sendMessage({type:"ADD_FRIEND",username:a.trim()});o.success?(t(`${a} added successfully!`),u(""),setTimeout(()=>{t("")},3e3),m()):f(o.error||"Failed to add friend")}catch(o){console.error("Error adding friend:",o),f("Failed to add friend. Please try again.")}finally{n(!1)}},i=async s=>{if(confirm(`Remove ${s} from your friends list?`))try{const o=await chrome.runtime.sendMessage({type:"REMOVE_FRIEND",username:s});o.success?c():alert("Failed to remove friend: "+o.error)}catch(o){console.error("Error removing friend:",o),alert("Failed to remove friend")}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"üë• Friends List"}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Add New Friend"}),e.jsxs("form",{onSubmit:x,className:"flex gap-3",children:[e.jsx("input",{type:"text",value:a,onChange:s=>u(s.target.value),placeholder:"Enter LeetCode username...",disabled:l,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-leetcode-medium focus:border-transparent disabled:bg-gray-100"}),e.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-leetcode-medium hover:bg-yellow-500 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Adding...":"+ Add Friend"})]}),p&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:p}),r&&e.jsxs("p",{className:"mt-2 text-sm text-green-600",children:["‚úì ",r]})]}),h?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading friends..."}):d.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üë•"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No friends added yet"}),e.jsx("p",{className:"text-sm",children:"Add your first friend using the form above!"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-semibold mb-3",children:["Current Friends (",d.length,")"]}),d.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("img",{src:s.profile.avatar||"https://via.placeholder.com/56",alt:s.profile.username,className:"w-14 h-14 rounded-full border-2 border-gray-200"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-lg",children:s.profile.username}),s.profile.realName&&e.jsx("p",{className:"text-sm text-gray-600",children:s.profile.realName}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Last updated: ",R(s.lastUpdated)]})]}),e.jsxs("div",{className:"flex gap-6 text-center mr-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:s.stats.streak}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"}),"Streak"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-700",children:s.stats.total}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total"})]})]}),e.jsx("button",{onClick:()=>i(s.profile.username),className:"px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",title:"Remove friend",children:"Remove"})]},s.profile.username))]})]})}function _(){const[d,h]=g.useState({}),[c,m]=g.useState(!0),[a,u]=g.useState(null);g.useEffect(()=>{l(),n()},[]);const l=async()=>{try{const t=await chrome.runtime.sendMessage({type:"GET_FRIENDS"});t.success&&h(t.friends)}catch(t){console.error("Error loading friends:",t)}finally{m(!1)}},n=async()=>{const{getStorageInfo:t}=await y(async()=>{const{getStorageInfo:i}=await import("./storage-CQGCbfl-.js");return{getStorageInfo:i}},[],import.meta.url),x=await t();u(x)},p=()=>{l(),n()},f=()=>{l(),n()},r=Object.values(d);return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-12",children:[e.jsx("div",{className:"bg-gradient-to-r from-leetcode-medium to-leetcode-easy text-white shadow-lg",children:e.jsxs("div",{className:"container mx-auto px-8 py-6",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(N,{className:"w-8 h-8"}),"LeetFriends Settings"]}),e.jsx("p",{className:"text-sm opacity-90 mt-2",children:"Manage your friend list and extension preferences"})]})}),e.jsx("div",{className:"container mx-auto px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(D,{friends:r,loading:c,onFriendRemoved:p,onFriendAdded:f})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Statistics"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Friends:"}),e.jsx("span",{className:"font-semibold",children:r.length})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Storage Used:"}),e.jsxs("span",{className:"font-semibold",children:[(a.bytesUsed/1024).toFixed(2)," KB"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Storage:"}),e.jsxs("span",{className:"font-semibold",children:[a.percentUsed,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-leetcode-medium h-2 rounded-full transition-all",style:{width:`${a.percentUsed}%`}})})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 border border-blue-200",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"‚ÑπÔ∏è How it Works"}),e.jsxs("ul",{className:"text-sm space-y-2 text-gray-700",children:[e.jsx("li",{children:"‚Ä¢ Data refreshes every 30 minutes"}),e.jsx("li",{children:"‚Ä¢ Streaks are calculated using UTC timezone"}),e.jsx("li",{children:"‚Ä¢ Click a friend card to see detailed stats"}),e.jsx("li",{children:"‚Ä¢ Get notifications for streak milestones"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"‚öôÔ∏è Actions"}),e.jsx("button",{onClick:async()=>{if(confirm("Are you sure you want to clear all data?")){const{clearAllData:t}=await y(async()=>{const{clearAllData:x}=await import("./storage-CQGCbfl-.js");return{clearAllData:x}},[],import.meta.url);await t(),window.location.reload()}},className:"w-full py-2 px-4 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors",children:"üóëÔ∏è Clear All Data"})]})]})]})}),e.jsx(w,{})]})}E.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(_,{})}));
